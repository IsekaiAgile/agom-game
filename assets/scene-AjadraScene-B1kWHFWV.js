class r extends Phaser.Scene{constructor(){super({key:"AjadraScene"}),this.currentLine=0,this.isTyping=!1,this.currentBGM=null}preload(){this.load.audio("fantasy-bgm","audio/fantasy-bgm.mp3"),this.load.image("bg-agairud","images/agairud_login.png")}scenario=[{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"？？？",text:"よくぞ辿り着いたドラ！ その歩みこそ、変化への第一歩だドラ"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"藤田",text:"……誰だ？ ここは……どこなんだ……"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"？？？",text:"ようこそ、アガイルドへ！ 自らを燃やし尽くし、変化を求めた旅人さんドラ！"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"藤田",text:"アガイルド……？ 竜……？ 僕は、死んだのか？"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"？？？",text:"死んじゃいないドラ。ここは、君のような『魂の停滞』に陥った者が、再生を待つ場所ドラ"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"ボクの名前はアジャドラ。君の『アジャイル（機敏な歩み）』を導く者だドラ！"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"藤田",text:"アジャイル……機敏な歩み……？"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"君は、独りで全部を背負って戦ってきたんだね。本当に、よく頑張ったドラ"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"でも、その戦い方は、自分を傷つけるだけだったドラ"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"藤田",text:"……自分を傷つける……そうだ、僕は……倒れて……"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"それは『責任』じゃなくて『呪い』だドラ。君は、自分を助けるのを忘れていたドラ"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"思い出させてあげるドラ。自分を活かし、仲間と共に生きるための、本当の力を"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"アジャドラ",text:"さあ、目を開けるドラ！ 変化を恐れない、あなたの本当の物語を始めるドラ！"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"藤田",text:"……本当の……物語……"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"",text:"（まばゆい光が画面を包み込む）"},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"",text:"..."},{background:"#2a1a3e",backgroundImage:"bg-agairud",speaker:"",text:"......"},{type:"nameReveal",text:"ん、何か声がしたような……"}];create(){console.log("AjadraScene: create started"),this.bgm=this.sound.add("fantasy-bgm",{loop:!0,volume:.5}),this.bgm.play(),console.log("Fantasy BGM started"),this.backgroundImage=this.add.image(640,360,"bg-agairud"),this.backgroundImage.setDisplaySize(1280,720),this.background=this.add.rectangle(640,360,1280,720,2759230),this.background.setDepth(-1),this.backgroundImage.setDepth(0),this.textWindow=this.add.rectangle(640,600,1200,200,0,.8),this.textWindow.setStrokeStyle(2,16737280),this.speakerText=this.add.text(100,520,"",{fontSize:"24px",color:"#ff6400",fontFamily:"sans-serif",fontStyle:"bold"}),this.dialogueText=this.add.text(100,560,"",{fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",wordWrap:{width:1080}}),this.clickIcon=this.add.text(1150,680,"▼",{fontSize:"24px",color:"#ff6400"}),this.clickIcon.setVisible(!1),this.tweens.add({targets:this.clickIcon,alpha:.3,duration:500,yoyo:!0,repeat:-1}),this.input.on("pointerdown",()=>this.advanceText()),this.showLine()}showLine(){if(this.currentLine>=this.scenario.length){this.dialogueText.setText("（続きを実装予定）"),this.stopBGM();return}const e=this.scenario[this.currentLine];if(e.type==="nameReveal"){this.showNameReveal(e);return}e.background&&this.background.setFillStyle(parseInt(e.background.replace("#","0x"))),e.backgroundImage&&this.backgroundImage.setTexture(e.backgroundImage),this.speakerText.setText(e.speaker),e.speaker===""?this.dialogueText.setStyle({fontSize:"24px",color:"#cccccc",fontFamily:"sans-serif",fontStyle:"italic",wordWrap:{width:1080}}):this.dialogueText.setStyle({fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",fontStyle:"normal",wordWrap:{width:1080}}),this.isTyping=!0,this.clickIcon.setVisible(!1),this.dialogueText.setText("");let a=50;e.text.includes("…")&&(a=70),e.speaker===""&&(a=40),(e.text==="..."||e.text==="......")&&(a=300);let t=0;const i=this.time.addEvent({delay:a,callback:()=>{this.dialogueText.setText(e.text.substring(0,t+1)),t++,t>=e.text.length&&(i.remove(),this.isTyping=!1,this.clickIcon.setVisible(!0))},loop:!0})}advanceText(){this.isTyping||(this.currentLine++,this.showLine())}showNameReveal(e){this.textWindow.setVisible(!1),this.speakerText.setVisible(!1),this.dialogueText.setVisible(!1),this.clickIcon.setVisible(!1);const a=this.add.text(640,360,e.text,{fontSize:"48px",color:"#ff6400",fontFamily:"sans-serif",fontStyle:"bold",align:"center"}).setOrigin(.5);a.setAlpha(0),this.tweens.add({targets:a,alpha:1,duration:2e3,onComplete:()=>{this.time.delayedCall(3e3,()=>{this.tweens.add({targets:a,alpha:0,duration:2e3,onComplete:()=>{a.destroy(),this.dialogueText.setVisible(!0),this.dialogueText.setText("（続きを実装予定）")}})})}})}stopBGM(){this.bgm&&this.bgm.isPlaying&&this.bgm.stop()}}export{r as A};
