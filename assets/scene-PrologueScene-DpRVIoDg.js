import{P as i}from"./phaser-Jt__PiWe.js";class g extends i.Scene{constructor(){super("PrologueScene"),this.currentLine=0,this.isTyping=!1,this.currentBGM=null}preload(){console.log("Loading audio files..."),this.load.audio("dark-bgm","audio/dark-bgm.mp3"),this.load.audio("fantasy-bgm","audio/fantasy-bgm.mp3"),console.log("Loading background images..."),this.load.image("bg-room","images/room.png"),this.load.image("bg-train-morning","images/train_morning.png"),this.load.image("bg-office-morning","images/office_morning.png"),this.load.image("bg-office-night","images/office_night.png"),this.load.image("bg-train-night","images/train_night.png"),this.load.image("bg-dark","images/dark.png"),this.load.image("bg-agairud","images/agairud_login.png"),this.load.on("filecomplete",e=>{console.log("Loaded:",e)}),this.load.on("loaderror",e=>{console.error("Failed to load:",e.key,e.src)})}scenario=[{type:"choice",question:"朝、目覚めますか？",gameOverText:`あなたは永遠に眠り続けた。
目覚めることは、二度となかった...`},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……う、あ……"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"",text:"（アラームを止める。画面には『06:00』の文字）"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……寝た気がしない。いや、一瞬も意識が途切れなかった"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"目を閉じても、頭の中でずっと今日のタスクの段取りが回っていた"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……あと1時間は寝れるはずだ。目だけ、目だけ瞑ろう……"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……ダメだ。あのバグ、昨日の修正で本当に直ったのか……？"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"あの資料、上司は納得するだろうか。クライアントは怒らないだろうか……"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……気がつけば、またアラームが鳴っている。心臓が嫌な速さで打っている"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……起きなきゃ。体が、冷たい泥のように重い"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"健康サプリ、ビタミン、……。これで、午前中は持つはずだ"},{background:"#0f0f1e",backgroundImage:"bg-room",speaker:"藤田",text:"……よし。行こう"},{type:"choice",question:"満員電車に乗りますか？",gameOverText:`あなたは会社に行かず、職を失った。
そして、社会から消えていった...`},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（駅までの数分で、もう息が切れている。酸素が足りない）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（……来た。今日を生き延びるための、最初の試練だ）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（ドア付近はダメだ。乗り降りのたびに弾き出されて消耗する）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（通路の……あの隙間。あそこが今日の僕の『陣地』だ）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（人波をかき分け、通路に滑り込む。周囲からの無言の圧力）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（毎日、ポジションは変わる。同じ日なんて、一日もない）"},{background:"#1a1a2e",backgroundImage:"bg-train-morning",speaker:"",text:"（誰かの肩が当たり、舌打ちが聞こえる。会社に着く頃には、心はもう磨り潰されている）"},{type:"choice",question:"仕事を始めますか？",gameOverText:`あなたは責任を放棄した。
チームは崩壊し、あなたは孤独になった...`},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"おはようございます……"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（PCを起動する。未読のチャット通知が画面の端を埋め尽くす）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……よし、今日のTODOリストをまとめ直そう"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"昨日の残り、さっき届いた割り込み、午後の定例会議の準備……"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（リストがどんどん長くなっていく。スクロールしても終わらない）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……多いな。見るだけで、胃の奥がギュッと縮む"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"上司",text:"フジ君、ちょっといいかな"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……はい、何でしょうか"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"上司",text:"例の件、君が出してくれた成果、評判いいよ。だからこれも追加で任せたい"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……承知しました。調整します"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（成果を出せば出すほど、仕事が増えていく）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（期待に応えれば応えるほど、自分の首が締まっていく）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（……無限だ。このサイクルに、出口なんて最初からなかったんだ）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……もう14時か。午前中が終わったなんて信じられない"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"お昼、外に食べに行く時間が……いや、このメールを返してからにしよう"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"",text:"（30分後。結局デスクで冷めたおにぎりを袋から出す）"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……味がしない。何を食べているのか、脳が認識していない"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"胃が重い。何かを摂取すること自体、体が拒絶している気がする"},{background:"#1a1a2e",backgroundImage:"bg-office-morning",speaker:"藤田",text:"……でも、エネルギーを入れないと。夜まで持たないんだ"},{type:"choice",question:"残業を始めますか？",gameOverText:`あなたはチームを見捨てた。
期待を裏切り、信頼を失った...`},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"藤田",text:"……ふぅ。やっと、静かになった"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"藤田",text:"日中は、目の前に来る仕事をスピーディーにこなすだけで終わる"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"藤田",text:"……ここからが、ようやく『自分の仕事』をする時間だ"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"",text:"（エナジードリンクと、さらにサプリ。ここからが本番だ）"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"",text:"（頼られている。期待されている。僕がやらなきゃいけないんだ）"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"",text:"（僕が止まれば、チームが止まる。それだけは、絶対にいけない）"},{background:"#0a0a1e",backgroundImage:"bg-office-night",speaker:"",text:"（激しくキーボードを叩く音。青白い光だけが、フジの青ざめた顔を照らす）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（……終電。今日も、なんとか滑り込んだ）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（朝ほどではないが、まだ満員だ。みんな、幽霊のような顔をしている）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（座りたい。……でも、空いていない。足が震えている）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（座席が一つ空く。しかし、隣の乗客が体を押し付けてきて、座ることができない）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（……痛いな。苦しいな。でも、それを訴える気力すら残っていない）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（揺られながら、また明日の段取りが頭をよぎる）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（……あ。あのバグ、再発しないだろうか）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（……明日の朝イチの会議、資料に不備はなかっただろうか）"},{background:"#050510",backgroundImage:"bg-train-night",speaker:"",text:"（……休みたい。……でも、休むのが怖い）"},{type:"choice",question:"まだ頑張れそうですか？",gameOverText:`あなたは限界を認めた。
しかし、それはもう遅すぎた...`},{background:"#050510",backgroundImage:"bg-room",speaker:"藤田",text:"……ただいま。……あぁ、食欲も、寝る気力すらない"},{background:"#050510",backgroundImage:"bg-room",speaker:"藤田",text:"仕事のことだけが、頭の中で渦を巻いている"},{background:"#050510",backgroundImage:"bg-room",speaker:"藤田",text:"……あれはやっただろうか。……大丈夫だろうか……"},{background:"#050510",backgroundImage:"bg-room",speaker:"藤田",text:"……ちょっとだけ、PCを確認……"},{background:"#050510",backgroundImage:"bg-room",speaker:"藤田",text:"……っ。急に、目の前が……"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"..."},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"......"},{background:"#000000",backgroundImage:"bg-dark",speaker:"藤田",text:"真っ暗だ。……何も、見えな……"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（心臓の音が「ドクン……」と重く響き、完全に消失する）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（完全な暗転。長い静寂）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"..."},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"......"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（……ああ、そうか。こういうことだったのか）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（頑張ることが、自分を殺すことになっていたんだ）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（成果を出すほどに、自分を絞め殺す縄は太くなっていく）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（……僕は、自分で自分を、この真っ暗な場所に追い込んだんだ）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"（……もう、いいよな。……これで、終わりに……）"},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"..."},{background:"#000000",backgroundImage:"bg-dark",speaker:"",text:"......"},{type:"sceneTransition",nextScene:"TrialScene",text:"意識が遠のいていく......"}];create(){console.log("PrologueScene: create started"),this.sound.context&&this.sound.context.resume(),this.audioUnlocked=!0,this.startGame()}showAudioUnlockScreen(){const e=this.add.rectangle(640,360,1280,720,0,.9);e.setDepth(1e3);const t=this.add.text(640,250,`AGOM
アガイルドの炎`,{fontSize:"64px",color:"#ff6400",fontFamily:"sans-serif",fontStyle:"bold",align:"center"}).setOrigin(.5);t.setDepth(1001);const o=this.add.text(640,400,"音楽を含みます",{fontSize:"24px",color:"#ffffff",fontFamily:"sans-serif",align:"center"}).setOrigin(.5);o.setDepth(1001);const a=this.add.rectangle(640,500,400,80,16737280);a.setDepth(1001),a.setInteractive({useHandCursor:!0});const n=this.add.text(640,500,"タップして開始",{fontSize:"32px",color:"#000000",fontFamily:"sans-serif",fontStyle:"bold"}).setOrigin(.5);n.setDepth(1002),a.on("pointerover",()=>{a.setFillStyle(16755200)}),a.on("pointerout",()=>{a.setFillStyle(16737280)}),a.on("pointerdown",()=>{this.sound.context&&this.sound.context.resume(),this.audioUnlocked=!0,e.destroy(),t.destroy(),o.destroy(),a.destroy(),n.destroy(),this.startGame()})}startGame(){this.backgroundImage=this.add.image(640,360,"bg-room"),this.backgroundImage.setDisplaySize(1280,720),this.background=this.add.rectangle(640,360,1280,720,1710638),this.background.setDepth(-1),this.backgroundImage.setDepth(0),this.textWindow=this.add.rectangle(640,600,1200,200,0,.8),this.textWindow.setStrokeStyle(2,16737280),this.speakerText=this.add.text(100,520,"",{fontSize:"24px",color:"#ff6400",fontFamily:"sans-serif",fontStyle:"bold"}),this.dialogueText=this.add.text(100,560,"",{fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",wordWrap:{width:1080}}),this.clickIcon=this.add.text(1150,680,"▼",{fontSize:"24px",color:"#ff6400"}),this.clickIcon.setVisible(!1),this.tweens.add({targets:this.clickIcon,alpha:.3,duration:500,yoyo:!0,repeat:-1}),this.createChoiceUI(),this.input.on("pointerdown",()=>this.advanceText()),this.showLine()}createChoiceUI(){this.choiceWindow=this.add.rectangle(640,360,600,300,0,.9),this.choiceWindow.setStrokeStyle(3,16737280),this.choiceWindow.setVisible(!1),this.questionText=this.add.text(640,280,"",{fontSize:"32px",color:"#ffffff",fontFamily:"sans-serif",align:"center"}).setOrigin(.5),this.questionText.setVisible(!1),this.yesButton=this.add.rectangle(640,360,200,60,16737280),this.yesButton.setStrokeStyle(2,16777215),this.yesButton.setInteractive({useHandCursor:!0}),this.yesButton.setVisible(!1),this.yesText=this.add.text(640,360,"はい",{fontSize:"28px",color:"#000000",fontFamily:"sans-serif",fontStyle:"bold"}).setOrigin(.5),this.yesText.setVisible(!1),this.noButton=this.add.rectangle(640,440,200,60,4473924),this.noButton.setStrokeStyle(2,16777215),this.noButton.setInteractive({useHandCursor:!0}),this.noButton.setVisible(!1),this.noText=this.add.text(640,440,"いいえ",{fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",fontStyle:"bold"}).setOrigin(.5),this.noText.setVisible(!1),this.yesButton.on("pointerover",()=>{this.yesButton.setFillStyle(16755200)}),this.yesButton.on("pointerout",()=>{this.yesButton.setFillStyle(16737280)}),this.noButton.on("pointerover",()=>{this.noButton.setFillStyle(6710886)}),this.noButton.on("pointerout",()=>{this.noButton.setFillStyle(4473924)})}showLine(){if(this.currentLine>=this.scenario.length){this.dialogueText.setText(`プロローグはここまでです。
（続きを実装予定）`),this.stopBGM();return}const e=this.scenario[this.currentLine];if(e.type==="sceneTransition"){this.transitionToNextScene(e);return}if(e.type==="choice"){this.showChoice(e);return}e.text&&e.text.includes("……ああ、そうか。こういうことだったのか")&&(console.log("Stopping BGM - Scene 8 detected"),this.stopBGM()),this.background.setFillStyle(parseInt(e.background.replace("#","0x"))),e.backgroundImage&&this.backgroundImage.setTexture(e.backgroundImage),this.speakerText.setText(e.speaker),e.speaker===""?this.dialogueText.setStyle({fontSize:"24px",color:"#cccccc",fontFamily:"sans-serif",fontStyle:"italic",wordWrap:{width:1080}}):this.dialogueText.setStyle({fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",fontStyle:"normal",wordWrap:{width:1080}}),this.isTyping=!0,this.clickIcon.setVisible(!1),this.dialogueText.setText("");let t=50;(e.text.includes("…")||e.text.includes("っ。")||e.text.includes("……"))&&(t=70),e.speaker===""&&(t=40),(e.text==="..."||e.text==="......")&&(t=300);let o=0;const a=this.time.addEvent({delay:t,callback:()=>{this.dialogueText.setText(e.text.substring(0,o+1)),o++,o>=e.text.length&&(a.remove(),this.isTyping=!1,this.clickIcon.setVisible(!0))},loop:!0})}advanceText(){this.isTyping||(this.currentLine++,this.showLine())}transitionToNextScene(e){console.log("Transitioning to:",e.nextScene),this.currentBGM&&this.currentBGM.isPlaying&&this.tweens.add({targets:this.currentBGM,volume:0,duration:1e3,onComplete:()=>{this.currentBGM.stop()}}),this.cameras.main.fadeOut(1e3,0,0,0),this.cameras.main.once("camerafadeoutcomplete",()=>{this.scene.start(e.nextScene)}),e.text&&this.dialogueText.setText(e.text)}playBGM(e){if(console.log("playBGM called with key:",e),!this.audioUnlocked){console.log("Audio not unlocked yet");return}if(this.currentBGM&&this.currentBGM.key===e&&this.currentBGM.isPlaying){console.log("BGM already playing:",e);return}if(this.currentBGM&&(console.log("Stopping current BGM"),this.currentBGM.stop()),e)try{console.log("Creating and playing new BGM:",e),this.currentBGM=this.sound.add(e,{loop:!0,volume:.5}),this.currentBGM.play(),console.log("BGM playing:",this.currentBGM.isPlaying)}catch(t){console.error("Error playing BGM:",t)}}stopBGM(){this.currentBGM&&(this.currentBGM.stop(),this.currentBGM=null)}showChoice(e){this.textWindow.setVisible(!1),this.speakerText.setVisible(!1),this.dialogueText.setVisible(!1),this.clickIcon.setVisible(!1),this.choiceWindow.setVisible(!0),this.questionText.setText(e.question),this.questionText.setVisible(!0),this.yesButton.setVisible(!0),this.yesText.setVisible(!0),this.noButton.setVisible(!0),this.noText.setVisible(!0),this.yesButton.removeAllListeners(),this.noButton.removeAllListeners(),this.yesButton.once("pointerdown",()=>{this.hideChoice(),this.currentLine++,this.currentLine===1&&!this.currentBGM&&(console.log("Starting dark-bgm after user interaction..."),this.playBGM("dark-bgm")),this.showLine()}),this.noButton.once("pointerdown",()=>{this.showGameOver(e.gameOverText)})}hideChoice(){this.choiceWindow.setVisible(!1),this.questionText.setVisible(!1),this.yesButton.setVisible(!1),this.yesText.setVisible(!1),this.noButton.setVisible(!1),this.noText.setVisible(!1),this.textWindow.setVisible(!0),this.speakerText.setVisible(!0),this.dialogueText.setVisible(!0)}showGameOver(e){this.stopBGM(),this.hideChoice(),this.textWindow.setVisible(!1),this.speakerText.setVisible(!1),this.dialogueText.setVisible(!1),this.clickIcon.setVisible(!1),this.background.setFillStyle(2228224),this.add.text(640,250,"GAME OVER",{fontSize:"72px",color:"#ff0000",fontFamily:"sans-serif",fontStyle:"bold"}).setOrigin(.5),this.add.text(640,360,e,{fontSize:"28px",color:"#ffffff",fontFamily:"sans-serif",align:"center"}).setOrigin(.5);const t=this.add.rectangle(640,500,300,60,16737280);t.setStrokeStyle(2,16777215),t.setInteractive({useHandCursor:!0}),this.add.text(640,500,"最初からやり直す",{fontSize:"24px",color:"#000000",fontFamily:"sans-serif",fontStyle:"bold"}).setOrigin(.5),t.on("pointerover",()=>{t.setFillStyle(16755200)}),t.on("pointerout",()=>{t.setFillStyle(16737280)}),t.on("pointerdown",()=>{this.scene.restart()})}}export{g as P};
